# cmstp 
## chatgpt 
cmstp是一个Windows命令行工具，用于安装和配置连接管理器配置文件。以下是cmstp命令的详细解释：

语法：

```
cmstp /?
cmstp [/PU <Pathname>] [/AU <Pathname>] [/NI] [/L <LogFile>] [/F] [/S] [/T] [/A] [/I] [/O <Section>] [/Q] [/R] [/CM] [/X <CustomAction>] [/N <Service>] [/D <Device>] [/P <Proxy>] [/U <User>] [/PW <Password>] [/W <Workstation>] [/V <Location>] [/G <MobileOperator>] [/E <PhoneNumber>] [/B] [/Y] [/Z] [/H] [/GPO]
```

参数说明：

`/PU`：生成的 .CMS 文件的可执行路径（必需）。

`/AU`：在用户的上下文中运行安装。这个选项将从用户上下文安装配置文件。必须输工的文件名。

`/NI`：对于线路断开（对于可以离线运行的配置），不再显示错误消息。如果设置此选项，则用户将不会看到为了成功完成cmstp操作必须连接的消息

`/L`：自定义执行日志的路径。

`/F`：强制在愿意或不愿意的情况下进行安装。

`/S`：在悄悄地安装配置文件时有用。离开屏幕空白，并在安装期间使用“请稍候”光标。除非出错，否则不会显示任何消息，且没有 UI 提示。

`/T`：运行文件测试。

`/A`：增加自动评论，例如自动化界面。

`/I`：安装指定名称的应用程序。

`/O`：重定向输出到指定的节（配置）。

`/Q`：始终安静模式。在客户端电脑上自动安装连接，而不提示用户，以确保 MDM 策略得到实施。

`/R`：生成输出文件，用于通过 SCCM 管理。此选项将日志格式化为 CSV 字段，并在输出中添加两个额外字段：一个将废弃的输出文件中的条目标记为“排除”，另一个根据日志中的错误代码添加“驳回”（例如MDM 错误）。

`/CM`：在连接管理器命令行界面中运行。如果显式使用 /LU 选项，则 cmstp 不会停止。否则 cmstp 将在不产生输出并且不显示错误时停止。

`/X`：提供完全自定义 ActionName (应用程序) 值。应用程序可以在某些情况下登记，例如在 NAC 中。

`/N`：指定所需的 Windows 服务。

`/D`：指定所需的 Windows 设备。

`/P`：使用指定的代理服务器（例如，ipv4:192.168.0.1），或代理名称。

`/U`：用户名。

`/PW`：对应的密码。

`/W`：工作站名称。

`/V`：位置 ID（例如地点 1）。

`/G`：网络运营商的名称。

`/E`：指定电话号码。

`/B`：触发一个启动通知。

`/Y`：始终将 CMAK UI 映射到 Disk C。

`/Z`：强制安装位于 U 目录的组策略。

`/H`：应用高 DPI 设置，从而使 UI 显示正确。

`/GPO`：将模板填充为 GPO。模板应该是 XML 文件，且只包含模板的元素。在此模式下，cmstp 发出错误代码（失败），如果标题不为“重定位”或在 wsus 策略下找到欺诈性证书。

示例：

```
cmstp /s /au "name-of-the-command-file.cms"
```

此示例演示了如何使用cmstp，在静默模式下运行名为name-of-the-command-file.cms的命令文件，并在用户上下文中执行命令。命令文件所在的路径必须在命令中指定。 

## tldr 
 
> 用于管理连接服务配置文件的命令行工具。
> 更多信息：<https://learn.microsoft.com/windows-server/administration/windows-commands/cmstp>.

- 安装指定的配置文件：

`cmstp "{{配置文件的路径}}"`

- 安装时不创建桌面快捷方式：

`cmstp /ns "{{配置文件的路径}}"`

- 安装时不检查依赖：

`cmstp /nf "{{配置文件的路径}}"`

- 仅为当前用户安装：

`cmstp /su "{{配置文件的路径}}"`

- 为所有用户安装（需要管理员权限）：

`cmstp /au "{{配置文件的路径}}"`

- 静默安装：

`cmstp /s "{{配置文件的路径}}"`

- 卸载一个指定的配置文件：

`cmstp /u "{{配置文件的路径}}"`

- 静默删除：

`cmstp /u /s "{{配置文件的路径}}"`
